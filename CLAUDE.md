## Task Tracking (Beads / bd)
- Use `bd` for ALL tasks/issues (no markdown TODO lists).
- Start of session: `bd ready`
- Create work: `bd create "Title" -p 1 --description "Context + acceptance criteria"`
- Update status: `bd update <id> --status in_progress`
- Finish: `bd close <id> --reason "Done"`
- End of session: `bd sync` (flush/import/export + git sync)
- Manual testing safety:
  - Prefer `BEADS_DIR` to isolate a workspace if needed. (`BEADS_DB` exists but is deprecated.)


# CLAUDE.md


### Beads upgrades
- After upgrading `bd`, run: `bd info --whats-new`
- If `bd info` warns about hooks, run: `bd hooks install`
This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Repository Overview

Claude Code plugins marketplace and learning hub. 258 plugins across 18 categories with 240 Agent Skills. Live at https://claudecodeplugins.io/

**Monorepo structure:** pnpm workspaces with MCP plugins in `plugins/mcp/*` and Astro website in `marketplace/`.

## Essential Commands

### Before ANY Commit
```bash
pnpm run sync-marketplace           # Regenerates marketplace.json from .extended.json
./scripts/validate-all-plugins.sh   # Full validation suite
```

### Build & Test
```bash
pnpm install                        # Install all dependencies
pnpm build                          # Build all MCP plugins
pnpm test                           # Run all tests
pnpm typecheck                      # TypeScript validation
pnpm lint                           # ESLint
```

### Single MCP Plugin
```bash
cd plugins/mcp/[plugin-name]/
pnpm build                          # Compile TypeScript â†’ dist/
pnpm test                           # Run plugin tests
```

### Marketplace Website
```bash
cd marketplace/
npm run dev                         # Dev server at localhost:4321
npm run build                       # Production build (auto-deploys on push)
```

### Validation Scripts
```bash
./scripts/validate-all-plugins.sh                    # Full validation
./scripts/validate-all-plugins.sh plugins/mcp/foo/   # Single plugin
python3 scripts/validate-skills-schema.py            # Skills 2025 schema
python3 scripts/validate-frontmatter.py              # Markdown frontmatter
node scripts/validate-plugin.js                      # Plugin structure
```

## Critical Architecture: Two Catalog System

**Source of Truth:** `.claude-plugin/marketplace.extended.json`
- Edit this file when adding/updating plugins
- Contains extended metadata: `featured`, `mcpTools`, `pricing`, `components`

**Generated File:** `.claude-plugin/marketplace.json`
- Auto-generated by `pnpm run sync-marketplace`
- **NEVER edit directly** - stripped for CLI compatibility
- CI fails if out of sync

The sync script (`scripts/sync-marketplace.cjs`) removes fields the Claude CLI rejects.

## Plugin Types

1. **AI Instruction Plugins** (98%): Markdown files with YAML frontmatter, no code execution
2. **MCP Server Plugins** (6 plugins): TypeScript/Node.js apps using `@modelcontextprotocol/sdk`
3. **Agent Skills** (240 equipped): Auto-activating capabilities via `skills/[name]/SKILL.md`

## Adding a New Plugin

```bash
# 1. Create structure
mkdir -p plugins/[category]/your-plugin/.claude-plugin
mkdir -p plugins/[category]/your-plugin/commands
mkdir -p plugins/[category]/your-plugin/skills/skill-adapter

# 2. Create required files:
#    - .claude-plugin/plugin.json
#    - README.md
#    - LICENSE

# 3. Add to marketplace.extended.json, then:
pnpm run sync-marketplace
./scripts/validate-all-plugins.sh plugins/[category]/your-plugin/
```

**Categories:** productivity, security, devops, ai-ml, database, api-development, crypto, performance, community, mcp, examples, and others.

## Agent Skills (2025 Schema)

SKILL.md frontmatter format:
```yaml
---
name: skill-name
description: |
  What this skill does. Include trigger phrases.
allowed-tools: Read, Write, Edit, Grep, Bash
version: 1.0.0
---
```

## Key Conventions

- **Paths in hooks:** Use `${CLAUDE_PLUGIN_ROOT}` for portability
- **Scripts:** All `.sh` files must be executable (`chmod +x`)
- **Model IDs:** Use `sonnet` or `haiku` (not `opus` - deprecated)
- **Versioning:** Update VERSION, package.json, and marketplace.extended.json together

## CI/CD Workflows

- **validate-plugins.yml** - PR/push: JSON validation, structure checks, security scans
- **deploy-marketplace.yml** - Auto-deploys Astro site to GitHub Pages
- **daily-skill-generator.yml** - Generates Agent Skills via Vertex AI
- **release.yml** - Manual release workflow with tagging

## Marketplace Identifiers

- **Slug:** `claude-code-plugins-plus`
- **Repo:** `jeremylongshore/claude-code-plugins`
- **Install:** `/plugin marketplace add jeremylongshore/claude-code-plugins`