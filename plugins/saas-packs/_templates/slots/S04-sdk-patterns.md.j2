---
name: {{ company }}-sdk-patterns
description: |
  {{ display_name }} SDK patterns for TypeScript and Python with best practices.
  Trigger phrases: "{{ company }} SDK patterns", "{{ company }} best practices",
  "{{ company }} code patterns", "idiomatic {{ company }}".
allowed-tools: Read, Write, Edit
version: 1.0.0
license: MIT
author: Jeremy Longshore <jeremy@intentsolutions.io>
---

# {{ display_name }} SDK Patterns

## Overview
Production-ready patterns for {{ display_name }} SDK usage in TypeScript and Python.

## Client Initialization Patterns

### Singleton Pattern (Recommended)
```typescript
// src/{{ company }}/client.ts
import { {{ client_class | default(display_name + 'Client') }} } from '{{ npm_package | default(company + '-sdk') }}';

let instance: {{ client_class | default(display_name + 'Client') }} | null = null;

export function get{{ display_name }}Client(): {{ client_class | default(display_name + 'Client') }} {
  if (!instance) {
    instance = new {{ client_class | default(display_name + 'Client') }}({
      apiKey: process.env.{{ company | upper }}_API_KEY!,
      {{ client_options | default('// Additional options') }}
    });
  }
  return instance;
}
```

### Factory Pattern (Multi-tenant)
```typescript
const clients = new Map<string, {{ client_class | default(display_name + 'Client') }}>();

export function getClientForTenant(tenantId: string): {{ client_class | default(display_name + 'Client') }} {
  if (!clients.has(tenantId)) {
    const apiKey = getTenantApiKey(tenantId);
    clients.set(tenantId, new {{ client_class | default(display_name + 'Client') }}({ apiKey }));
  }
  return clients.get(tenantId)!;
}
```

## Error Handling Pattern

```typescript
import { {{ error_class | default(display_name + 'Error') }} } from '{{ npm_package | default(company + '-sdk') }}';

async function safe{{ display_name }}Call<T>(
  operation: () => Promise<T>
): Promise<{ data: T | null; error: Error | null }> {
  try {
    const data = await operation();
    return { data, error: null };
  } catch (err) {
    if (err instanceof {{ error_class | default(display_name + 'Error') }}) {
      // Log structured error
      console.error({
        code: err.code,
        message: err.message,
        {{ error_fields | default('// Additional error fields') }}
      });
    }
    return { data: null, error: err as Error };
  }
}
```

## Retry Pattern

```typescript
async function withRetry<T>(
  operation: () => Promise<T>,
  maxRetries = 3,
  backoffMs = 1000
): Promise<T> {
  for (let attempt = 1; attempt <= maxRetries; attempt++) {
    try {
      return await operation();
    } catch (err) {
      if (attempt === maxRetries) throw err;
      const delay = backoffMs * Math.pow(2, attempt - 1);
      await new Promise(r => setTimeout(r, delay));
    }
  }
  throw new Error('Unreachable');
}
```

## Type Safety Patterns

```typescript
// Strict typing for API responses
interface {{ response_type | default(display_name + 'Response') }}<T> {
  data: T;
  meta: {
    requestId: string;
    timestamp: string;
  };
}

// Zod validation for runtime safety
import { z } from 'zod';

const {{ company }}ResponseSchema = z.object({
  {{ zod_schema | default('// Define schema fields') }}
});
```

## Python Patterns

```python
from contextlib import asynccontextmanager
from {{ pip_package | default(company) }} import {{ client_class | default(display_name + 'Client') }}

@asynccontextmanager
async def get_{{ company }}_client():
    client = {{ client_class | default(display_name + 'Client') }}()
    try:
        yield client
    finally:
        await client.close()
```

## Next Steps
Apply patterns in `{{ company }}-core-workflow-a` for real-world usage.
