---
name: {{ company }}-deploy-integration
description: |
  Deploy {{ display_name }} applications to Vercel, Fly.io, and Cloud Run.
  Use when deploying to production or configuring deployment pipelines.
  Trigger with phrases like "deploy {{ company }}", "{{ company }} Vercel",
  "{{ company }} production deploy", "{{ company }} Cloud Run".
allowed-tools: Read, Write, Edit, Bash({{ company }}:*)
version: 1.0.0
license: MIT
author: Jeremy Longshore <jeremy@intentsolutions.io>
---

# {{ display_name }} Deploy Integration

## Overview
Deploy {{ display_name }}-powered applications to popular cloud platforms.

## Prerequisites
- {{ company }}-prod-checklist completed
- Account on target platform (Vercel/Fly.io/GCP)
- Production API keys ready
- CLI tools installed for target platform

## Instructions

### Step 1: Vercel Deployment
```bash
# Add secrets
vercel secrets add {{ company }}_api_key sk_live_***

# Deploy
vercel --prod
```

### Step 2: Fly.io Deployment
```bash
# Set secrets
fly secrets set {{ company | upper }}_API_KEY=sk_live_***

# Deploy
fly deploy
```

### Step 3: Cloud Run Deployment
```bash
gcloud run deploy {{ company }}-service \
  --image gcr.io/$PROJECT_ID/{{ company }}-service \
  --set-secrets={{ company | upper }}_API_KEY={{ company }}-api-key:latest
```

## Output
- Application deployed to cloud platform
- Environment variables configured securely
- Health check endpoint responding
- Secrets stored in platform's secret manager

## Error Handling

| Error | Cause | Solution |
|-------|-------|----------|
| Secret not found | Missing platform secret | Add secret using platform CLI |
| Build failed | Missing dependencies | Check package.json and build logs |
| Health check failed | App not starting | Check application logs |
| Permission denied | IAM misconfiguration | Update service account permissions |

## Examples

### Vercel Configuration
```json
{
  "env": {
    "{{ company | upper }}_API_KEY": "@{{ company }}_api_key"
  },
  "functions": {
    "api/**/*.ts": { "maxDuration": 30 }
  }
}
```

### Fly.io Configuration
```toml
app = "my-{{ company }}-app"
primary_region = "{{ primary_region | default('iad') }}"

[env]
  NODE_ENV = "production"

[http_service]
  internal_port = 3000
  force_https = true
```

### Health Check Endpoint
```typescript
export async function GET() {
  const status = await check{{ display_name }}Connection();
  return Response.json({
    status: status ? 'healthy' : 'degraded',
    services: { {{ company }}: status },
  });
}
```

## Resources
- [Vercel Documentation](https://vercel.com/docs)
- [Fly.io Documentation](https://fly.io/docs)
- [Cloud Run Documentation](https://cloud.google.com/run/docs)

## Next Steps
For webhook handling, see `{{ company }}-webhooks-events`.
